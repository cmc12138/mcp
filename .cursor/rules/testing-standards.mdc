---
globs: tests/**/*.ts,**/*.test.ts,**/*.spec.ts
description: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•çš„ç¼–å†™è§„èŒƒ
---

# æµ‹è¯•æ ‡å‡†è§„åˆ™

## æµ‹è¯•æ–‡ä»¶ç»„ç»‡

### æµ‹è¯•ç›®å½•ç»“æ„

- `tests/unit/` - å•å…ƒæµ‹è¯•
- `tests/integration/` - é›†æˆæµ‹è¯•
- `tests/fixtures/` - æµ‹è¯•æ•°æ®å’Œæ¨¡æ‹Ÿæ–‡ä»?- `tests/__mocks__/` - Mockå®ç°

### æµ‹è¯•æ–‡ä»¶å‘½å

- å•å…ƒæµ‹è¯•ï¼š`ComponentAnalyzer.test.ts`
- é›†æˆæµ‹è¯•ï¼š`mcp-server.test.ts`
- æµ‹è¯•å·¥å…·ï¼š`setup.ts`

## å•å…ƒæµ‹è¯•è§„èŒƒ

### æµ‹è¯•ç»“æ„æ¨¡å¼

```typescript
describe('ComponentAnalyzer', () => {
  let analyzer: ComponentAnalyzer;

  beforeEach(() => {
    analyzer = new ComponentAnalyzer();
  });

  describe('analyzeComponents', () => {
    it('should analyze functional React components correctly', () => {
      // æµ‹è¯•å®ç°
    });
  });
});
```

### æµ‹è¯•ç”¨ä¾‹å‘½å

- ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°
- éµå¾ª "should [expected behavior] when [condition]" æ ¼å¼
- ä½¿ç”¨ä¸­æ–‡æè¿°å¤æ‚åœºæ™¯

```typescript
it('should detect React functional components with TypeScript props', () => {
  // æµ‹è¯•å®ç°
});

it('should handle arrow function components assigned to variables', () => {
  // æµ‹è¯•å®ç°
});
```

### æµ‹è¯•æ•°æ®ç®¡ç†

- ä½¿ç”¨fixturesç›®å½•å­˜å‚¨æµ‹è¯•ä»£ç ç¤ºä¾‹
- åˆ›å»ºå¯é‡ç”¨çš„æµ‹è¯•æ•°æ®ç”Ÿæˆå™?- ä½¿ç”¨describe.eachè¿›è¡Œå‚æ•°åŒ–æµ‹è¯?
```typescript
// æµ‹è¯•æ•°æ®ç¤ºä¾‹
const testComponents = [
  {
    name: 'functional component',
    code: `function UserCard({ name }: { name: string }) { return <div>{name}</div>; }`,
    expected: { type: 'functional', hasProps: true },
  },
];

describe.each(testComponents)('Component detection', ({ name, code, expected }) => {
  it(`should detect ${name}`, () => {
    // æµ‹è¯•å®ç°
  });
});
```

## é›†æˆæµ‹è¯•è§„èŒƒ

### MCPæœåŠ¡å™¨æµ‹è¯?
- æµ‹è¯•å®Œæ•´çš„MCPåè®®äº¤äº’
- æ¨¡æ‹Ÿå®¢æˆ·ç«¯è¯·æ±‚å’Œå“åº”
- éªŒè¯å·¥å…·å’Œèµ„æºçš„æ­£ç¡®æ€?
```typescript
describe('MCP Server Integration', () => {
  let server: FrontendAnalysisMCPServer;

  beforeEach(async () => {
    server = new FrontendAnalysisMCPServer();
    await server.initialize();
  });

  it('should handle analyze_project tool request', async () => {
    const result = await server.handleTool('analyze_project', {
      projectPath: './test-project',
    });

    expect(result).toHaveProperty('components');
    expect(result).toHaveProperty('functions');
  });
});
```

### ç«¯åˆ°ç«¯æµ‹è¯?
- æµ‹è¯•å®Œæ•´çš„åˆ†ææµç¨?- éªŒè¯ä»æ–‡ä»¶è¯»å–åˆ°ç»“æœè¾“å‡ºçš„å…¨é“¾è·¯
- æµ‹è¯•é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ?
## Mockå’ŒStubè§„èŒƒ

### å¤–éƒ¨ä¾èµ–Mock

- Mock Babelè§£æå™¨é¿å…æ–‡ä»¶ç³»ç»Ÿä¾èµ?- MockMCP SDKé¿å…ç½‘ç»œä¾èµ–
- ä½¿ç”¨Jestçš„mockåŠŸèƒ½

```typescript
// Mockç¤ºä¾‹
jest.mock('@babel/parser', () => ({
  parse: jest.fn().mockReturnValue(mockAST),
}));

jest.mock('@modelcontextprotocol/sdk', () => ({
  Server: jest.fn().mockImplementation(() => ({
    setRequestHandler: jest.fn(),
    setResourceHandler: jest.fn(),
  })),
}));
```

### æµ‹è¯•å·¥å…·å‡½æ•°

- åˆ›å»ºæµ‹è¯•ä¸“ç”¨çš„ASTç”Ÿæˆå™?- å®ç°æµ‹è¯•æ•°æ®éªŒè¯å·¥å…·
- æä¾›æ€§èƒ½æµ‹è¯•è¾…åŠ©å‡½æ•°

## æµ‹è¯•è¦†ç›–ç‡è¦æ±?
### è¦†ç›–ç‡ç›®æ ?
- è¡Œè¦†ç›–ç‡ï¼šâ‰¥90%
- åˆ†æ”¯è¦†ç›–ç‡ï¼šâ‰?5%
- å‡½æ•°è¦†ç›–ç‡ï¼šâ‰?5%
- è¯­å¥è¦†ç›–ç‡ï¼šâ‰?0%

### è¦†ç›–ç‡æŠ¥å‘?
- ä½¿ç”¨Jestå†…ç½®çš„è¦†ç›–ç‡æŠ¥å‘Š
- ç”ŸæˆHTMLå’ŒJSONæ ¼å¼æŠ¥å‘Š
- åœ¨CI/CDä¸­é›†æˆè¦†ç›–ç‡æ£€æŸ?
## æ€§èƒ½æµ‹è¯•è§„èŒƒ

### æ€§èƒ½åŸºå‡†æµ‹è¯•

- æµ‹è¯•å¤§å‹é¡¹ç›®çš„åˆ†ææ€§èƒ½
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
- è®¾ç½®æ€§èƒ½å›å½’æ£€æµ?
```typescript
describe('Performance Tests', () => {
  it('should analyze large project within time limit', async () => {
    const startTime = Date.now();
    const result = await analyzer.analyzeProject('./large-project');
    const duration = Date.now() - startTime;

    expect(duration).toBeLessThan(30000); // 30ç§’é™åˆ?    expect(result.components.length).toBeGreaterThan(100);
  });
});
```

### å†…å­˜æ³„æ¼æµ‹è¯•

- æµ‹è¯•é•¿æ—¶é—´è¿è¡Œçš„å†…å­˜ç¨³å®šæ€?- éªŒè¯å¯¹è±¡æ­£ç¡®é‡Šæ”¾
- ç›‘æ§å†…å­˜ä½¿ç”¨è¶‹åŠ¿

## æµ‹è¯•ç»´æŠ¤è§„èŒƒ

### æµ‹è¯•æ–‡æ¡£

- ä¸ºå¤æ‚æµ‹è¯•ç”¨ä¾‹æ·»åŠ æ³¨é‡?- ç»´æŠ¤æµ‹è¯•ç”¨ä¾‹çš„READMEæ–‡æ¡£
- è®°å½•æµ‹è¯•ç¯å¢ƒé…ç½®è¦æ±‚

### æµ‹è¯•é‡æ„

- å®šæœŸé‡æ„é‡å¤çš„æµ‹è¯•ä»£ç ?- æå–å…¬å…±æµ‹è¯•å·¥å…·å‡½æ•°
- ä¿æŒæµ‹è¯•ä»£ç çš„å¯è¯»æ€?
### æŒç»­é›†æˆ

- åœ¨æ¯æ¬¡æäº¤æ—¶è¿è¡Œæµ‹è¯•
- è®¾ç½®æµ‹è¯•å¤±è´¥æ—¶çš„é€šçŸ¥æœºåˆ¶
- ç»´æŠ¤ç¨³å®šçš„æµ‹è¯•ç¯å¢?
